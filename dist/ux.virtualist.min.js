!function(t){"use strict";t.module("virtualist",[]).directive("virtualist",function(){return{restrict:"A",replace:!1,scope:{virtualist:"="},link:function(e,i,r){function l(){var i="",r="";u*e.virtualist.length!==v&&(v=u*e.virtualist.length,t.element(h).css({height:v+"px",width:"100%"}));for(var l=m.length,n=0;l>n;n++){r=A;for(var s=g.length;s--;)r=r.replace("{{"+g[s]+"}}",m[n][g[s]]);i+=r}d.innerHTML=i}function n(){e.virtualist&&(m=e.virtualist.slice(f,b)),l()}function s(){f=Math.floor(c.scrollTop/u),b=f+p,n()}var a=i[0],c=a.parentNode,o=c.offsetHeight,u=parseInt(r.virtualistItemheight,0)||25,h=document.createElement("div"),v=0,p=Math.ceil(o/u),d=document.createElement(c.tagName),m=e.virtualist.slice(0,p),g=[],f=0,b=0,x=document.createElement("div"),A="",w=new RegExp("{{::","g"),C=i[0].hasAttribute("virtualist-complex");x.appendChild(a),x.children[0].removeAttribute("virtualist"),x.children[0].removeAttribute("virtualist-itemheight"),x.children[0].removeAttribute("virtualist-complex"),t.element(x.children[0]).removeClass("ng-scope ng-binding ng-isolate-scope"),x.children[0].getAttribute("class")||x.children[0].removeAttribute("class"),A=x.innerHTML,A=A.replace(w,"{{");for(var E=A.split("{{"),M=E.length;M--;)E[M].indexOf("}}")>-1&&g.push(E[M].substr(0,E[M].indexOf("}}")));t.element(d).css({position:"absolute",top:0,width:"100%"}),e.$watch("virtualist",function(){n()},C),c.appendChild(h),h.appendChild(d),s(),t.element(c).on("scroll",function(){s(),t.element(d).css({top:c.scrollTop+"px"})})}}})}(angular);
