!function(t){"use strict";t.module("ux.virtualist",[]).directive("uxVirtualist",function(){return{restrict:"A",replace:!1,scope:{uxVirtualist:"="},link:function(e,i,r){function l(){var i="",r="";o*e.uxVirtualist.length!==p&&(p=o*e.uxVirtualist.length,t.element(h).css({height:p+"px",width:"100%"}));for(var l=x.length,n=0;l>n;n++){r=V;for(var u=g.length;u--;)r=r.replace("{{"+g[u]+"}}",x[n][g[u]]);i+=r}m.innerHTML=i}function n(){e.uxVirtualist&&(x=e.uxVirtualist.slice(v,f)),l()}function u(){v=Math.floor(a.scrollTop/o),f=v+d,n()}var s=i[0],a=s.parentNode,c=a.offsetHeight,o=parseInt(r.uxVirtualistItemheight,0)||25,h=document.createElement("div"),p=0,d=Math.ceil(c/o),m=document.createElement(a.tagName),x=e.uxVirtualist.slice(0,d),g=[],v=0,f=0,b=document.createElement("div"),V="",A=new RegExp("{{::","g"),w=i[0].hasAttribute("ux-virtualist-complex");b.appendChild(s),b.children[0].removeAttribute("ux-virtualist"),b.children[0].removeAttribute("ux-virtualist-itemheight"),b.children[0].removeAttribute("ux-virtualist-complex"),t.element(b.children[0]).removeClass("ng-scope ng-binding ng-isolate-scope"),b.children[0].getAttribute("class")||b.children[0].removeAttribute("class"),V=b.innerHTML,V=V.replace(A,"{{");for(var C=V.split("{{"),E=C.length;E--;)C[E].indexOf("}}")>-1&&g.push(C[E].substr(0,C[E].indexOf("}}")));t.element(m).css({position:"absolute",top:0,width:"100%"}),e.$watch("uxVirtualist",function(){n()},w),a.appendChild(h),h.appendChild(m),u(),t.element(a).on("scroll",function(){u(),t.element(m).css({top:a.scrollTop+"px"})})}}})}(angular);
