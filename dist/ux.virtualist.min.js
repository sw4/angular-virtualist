!function(e){"use strict";e.module("ux.virtualist",[]).directive("uxVirtualist",function(){return{restrict:"A",replace:!1,scope:{uxVirtualist:"="},link:function(t,i,n){function l(){var i="",n="";a*t.uxVirtualist.length!==d&&(d=a*t.uxVirtualist.length,e.element(h).css({height:d+"px",width:"100%"}));for(var l=0;l<m.length;l++){n=b;for(var r=0;r<f.length;r++)n=n.replace("{{"+f[r]+"}}",m[l][f[r]]);i+=n}g.innerHTML=i}function r(){m=t.uxVirtualist.slice(x,v),l()}function s(){x=Math.floor(c.scrollTop/a),v=x+p,r()}var u=i[0],c=u.parentNode,o=c.offsetHeight,a=parseInt(n.uxVirtualistItemheight,0)||25,h=document.createElement("div"),d=0,p=Math.ceil(o/a),g=document.createElement(c.tagName),m=t.uxVirtualist.slice(0,p),f=[],x=0,v=0,V=document.createElement("div"),b="",A=new RegExp("{{::","g");V.appendChild(u),V.children[0].removeAttribute("ux-virtualist"),V.children[0].removeAttribute("ux-virtualist-itemheight"),e.element(V.children[0]).removeClass("ng-scope ng-binding ng-isolate-scope"),V.children[0].getAttribute("class")||V.children[0].removeAttribute("class"),b=V.innerHTML,b=b.replace(A,"{{"),console.log(b);for(var w=b.split("{{"),C=0;C<w.length;C++)w[C].indexOf("}}")>-1&&f.push(w[C].substr(0,w[C].indexOf("}}")));e.element(g).css({position:"absolute",top:0,width:"100%"}),t.$watch("uxVirtualist",function(){r()}),c.appendChild(h),h.appendChild(g),s(),e.element(c).on("scroll",function(){s(),e.element(g).css({top:c.scrollTop+"px"})})}}})}(angular);
